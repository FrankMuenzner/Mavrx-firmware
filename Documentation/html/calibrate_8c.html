<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Mavrx Multirotor Firmware: Thalamus/calibrate.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Mavrx Multirotor Firmware
   </div>
   <div id="projectbrief">Firmware for multirotors with Thalamus and Hypo</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('calibrate_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">calibrate.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for zeroing and calibrating sensors.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;all.h&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aac5716831fbfdd2f2b89346c7e77329c"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="calibrate_8c.html#aac5716831fbfdd2f2b89346c7e77329c">detect_ori</a> (void)</td></tr>
<tr class="memdesc:aac5716831fbfdd2f2b89346c7e77329c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects orientation of craft, used for selecting the right axis mixings.  <a href="#aac5716831fbfdd2f2b89346c7e77329c">More...</a><br/></td></tr>
<tr class="separator:aac5716831fbfdd2f2b89346c7e77329c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6660114ac60736ac58d375b4c6d2e47f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="calibrate_8c.html#a6660114ac60736ac58d375b4c6d2e47f">calibrate_ori</a> (void)</td></tr>
<tr class="memdesc:a6660114ac60736ac58d375b4c6d2e47f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects and stores the orientation of the craft.  <a href="#a6660114ac60736ac58d375b4c6d2e47f">More...</a><br/></td></tr>
<tr class="separator:a6660114ac60736ac58d375b4c6d2e47f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36fabae6abbd94eeb1a86e2be5ec096d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="calibrate_8c.html#a36fabae6abbd94eeb1a86e2be5ec096d">calibrate_mag</a> (void)</td></tr>
<tr class="memdesc:a36fabae6abbd94eeb1a86e2be5ec096d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibrates magnetometers (hard iron calibration)  <a href="#a36fabae6abbd94eeb1a86e2be5ec096d">More...</a><br/></td></tr>
<tr class="separator:a36fabae6abbd94eeb1a86e2be5ec096d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bdb227779ac545707b285be5e33395f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="calibrate_8c.html#a7bdb227779ac545707b285be5e33395f">calibrate_gyr</a> (void)</td></tr>
<tr class="memdesc:a7bdb227779ac545707b285be5e33395f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibrates gyro offsets and saves results.  <a href="#a7bdb227779ac545707b285be5e33395f">More...</a><br/></td></tr>
<tr class="separator:a7bdb227779ac545707b285be5e33395f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c788f773c9afb71d43cd7864f165e61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="calibrate_8c.html#a3c788f773c9afb71d43cd7864f165e61">calibrate_gyr_temporary</a> (unsigned int seconds)</td></tr>
<tr class="memdesc:a3c788f773c9afb71d43cd7864f165e61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibrates gyro offsets but don't save it.  <a href="#a3c788f773c9afb71d43cd7864f165e61">More...</a><br/></td></tr>
<tr class="separator:a3c788f773c9afb71d43cd7864f165e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for zeroing and calibrating sensors. </p>
<dl class="section author"><dt>Author</dt><dd>Yuan Gao </dd>
<dd>
Henry Fletcher </dd>
<dd>
Oskar Weigl </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7bdb227779ac545707b285be5e33395f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calibrate_gyr </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calibrates gyro offsets and saves results. </p>
<p>Performs a <a class="el" href="calibrate_8c.html#a3c788f773c9afb71d43cd7864f165e61" title="Calibrates gyro offsets but don&#39;t save it. ">calibrate_gyr_temporary()</a> and then saves to EEPROM </p>

</div>
</div>
<a class="anchor" id="a3c788f773c9afb71d43cd7864f165e61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calibrate_gyr_temporary </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>seconds</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calibrates gyro offsets but don't save it. </p>
<p>Performs gyro offset calibration, but don't save it to EEPROM.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">seconds</td><td>number of seconds to take calibration for </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a36fabae6abbd94eeb1a86e2be5ec096d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calibrate_mag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calibrates magnetometers (hard iron calibration) </p>
<p>This function does a hard iron calibration of the magnetometers, this is achieved simply by swinging the magnetometers around and measuring the maximum and minimum axis readings.</p>
<p>Soft iron calibrations are hard-coded.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>soft iron calibration on the navy craft </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>filter out spikes </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Inline delay </dd></dl>

</div>
</div>
<a class="anchor" id="a6660114ac60736ac58d375b4c6d2e47f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calibrate_ori </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detects and stores the orientation of the craft. </p>
<p>This function detects and then stores the orientation of the craft in EEPROM. (and then plays an animation on the props to notify of this). This function only needs to be run once (or after a firmware update with a different EEPROM version) </p>

</div>
</div>
<a class="anchor" id="aac5716831fbfdd2f2b89346c7e77329c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char detect_ori </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detects orientation of craft, used for selecting the right axis mixings. </p>
<p>The same code can be used on several different craft, some of which mount the flight controller in a different orientation. This function detects which orientation Thalamus is in so that the correct axes can be used. This function simply calculates this from which axis is down. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_bfc07db8d2defe76e29ff476daeb588c.html">Thalamus</a></li><li class="navelem"><a class="el" href="calibrate_8c.html">calibrate.c</a></li>
    <li class="footer">Generated on Fri Sep 13 2013 17:44:16 for Mavrx Multirotor Firmware by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
