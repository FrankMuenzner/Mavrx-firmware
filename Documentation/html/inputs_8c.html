<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Mavrx Multirotor Firmware: Thalamus/inputs.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Mavrx Multirotor Firmware
   </div>
   <div id="projectbrief">Firmware for multirotors with Thalamus and Hypo</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('inputs_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">inputs.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Sensor and user inputs.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;all.h&quot;</code><br/>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3935302654f0349bc61d4090915960e7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3935302654f0349bc61d4090915960e7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a3935302654f0349bc61d4090915960e7">gps_status</a> (void)</td></tr>
<tr class="memdesc:a3935302654f0349bc61d4090915960e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Filters GPS and barometer altitude. <br/></td></tr>
<tr class="separator:a3935302654f0349bc61d4090915960e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b83a366a672f3dc32fbed71e5ebe077"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a1b83a366a672f3dc32fbed71e5ebe077">read_rx_input</a> (void)</td></tr>
<tr class="memdesc:a1b83a366a672f3dc32fbed71e5ebe077"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads RX data.  <a href="#a1b83a366a672f3dc32fbed71e5ebe077">More...</a><br/></td></tr>
<tr class="separator:a1b83a366a672f3dc32fbed71e5ebe077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6725290e9b01a22f7007bb2811bd1e49"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6725290e9b01a22f7007bb2811bd1e49"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a6725290e9b01a22f7007bb2811bd1e49">read_barometer</a> (void)</td></tr>
<tr class="memdesc:a6725290e9b01a22f7007bb2811bd1e49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and filters barometer. <br/></td></tr>
<tr class="separator:a6725290e9b01a22f7007bb2811bd1e49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabf836b0ea199cde8e1082eeb6e1dff8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#aabf836b0ea199cde8e1082eeb6e1dff8">read_ultrasound</a> (void)</td></tr>
<tr class="memdesc:aabf836b0ea199cde8e1082eeb6e1dff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and filters the ultrasound.  <a href="#aabf836b0ea199cde8e1082eeb6e1dff8">More...</a><br/></td></tr>
<tr class="separator:aabf836b0ea199cde8e1082eeb6e1dff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e9c8a4354e4a05ed89dc4313e6ac4c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a5e9c8a4354e4a05ed89dc4313e6ac4c6">trig_batt_voltage</a> (void)</td></tr>
<tr class="memdesc:a5e9c8a4354e4a05ed89dc4313e6ac4c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Triggers ADC for the battery voltage.  <a href="#a5e9c8a4354e4a05ed89dc4313e6ac4c6">More...</a><br/></td></tr>
<tr class="separator:a5e9c8a4354e4a05ed89dc4313e6ac4c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299508501b2f693e86c625f7f0d6cf07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a299508501b2f693e86c625f7f0d6cf07">read_batt_voltage</a> (void)</td></tr>
<tr class="memdesc:a299508501b2f693e86c625f7f0d6cf07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads ADC for the battery voltage.  <a href="#a299508501b2f693e86c625f7f0d6cf07">More...</a><br/></td></tr>
<tr class="separator:a299508501b2f693e86c625f7f0d6cf07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e97ee9276ed405c66f9d3f39f83ff99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a9e97ee9276ed405c66f9d3f39f83ff99">convert_ori</a> (volatile signed short *X, volatile signed short *Y, volatile signed short *Z, signed short *data)</td></tr>
<tr class="memdesc:a9e97ee9276ed405c66f9d3f39f83ff99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts sensor axes to body axes.  <a href="#a9e97ee9276ed405c66f9d3f39f83ff99">More...</a><br/></td></tr>
<tr class="separator:a9e97ee9276ed405c66f9d3f39f83ff99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf86f7c6ce91aa7d1b2ecdcd969a8100"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abf86f7c6ce91aa7d1b2ecdcd969a8100"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#abf86f7c6ce91aa7d1b2ecdcd969a8100">read_gyr_sensors</a> (void)</td></tr>
<tr class="memdesc:abf86f7c6ce91aa7d1b2ecdcd969a8100"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and filters the gyroscopes. <br/></td></tr>
<tr class="separator:abf86f7c6ce91aa7d1b2ecdcd969a8100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52789b5b751a66d96efbd4affda216ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a52789b5b751a66d96efbd4affda216ba">read_acc_sensors</a> (void)</td></tr>
<tr class="memdesc:a52789b5b751a66d96efbd4affda216ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and filters the accelerometers.  <a href="#a52789b5b751a66d96efbd4affda216ba">More...</a><br/></td></tr>
<tr class="separator:a52789b5b751a66d96efbd4affda216ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4980606e2fc3dcfdf7a38bdb74ec0d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#ab4980606e2fc3dcfdf7a38bdb74ec0d4">read_mag_sensors</a> (void)</td></tr>
<tr class="memdesc:ab4980606e2fc3dcfdf7a38bdb74ec0d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads and filters the magnetometers.  <a href="#ab4980606e2fc3dcfdf7a38bdb74ec0d4">More...</a><br/></td></tr>
<tr class="separator:ab4980606e2fc3dcfdf7a38bdb74ec0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a01020628802e60dee9f2e968dcab2f46"><td class="memItemLeft" align="right" valign="top">unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a01020628802e60dee9f2e968dcab2f46">rcInput</a> [7]</td></tr>
<tr class="separator:a01020628802e60dee9f2e968dcab2f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a078122be7eecea02fe0bdd599e46208c"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a078122be7eecea02fe0bdd599e46208c">rxLoss</a> =0</td></tr>
<tr class="separator:a078122be7eecea02fe0bdd599e46208c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa8bbbd92bae257cc2aaf699f2ccaca"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#acfa8bbbd92bae257cc2aaf699f2ccaca">rxFirst</a> =0</td></tr>
<tr class="separator:acfa8bbbd92bae257cc2aaf699f2ccaca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14eb9bc48de692883e38db2a9a6ba75c"><td class="memItemLeft" align="right" valign="top">signed short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a14eb9bc48de692883e38db2a9a6ba75c">yawtrim</a> =0</td></tr>
<tr class="separator:a14eb9bc48de692883e38db2a9a6ba75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89aca8357300b0f6d1f6257307456b54"><td class="memItemLeft" align="right" valign="top">signed short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a89aca8357300b0f6d1f6257307456b54">throttletrim</a> =0</td></tr>
<tr class="separator:a89aca8357300b0f6d1f6257307456b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adca97acc6b0ff71f782f9c8a484a47b8"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#adca97acc6b0ff71f782f9c8a484a47b8">throttle</a> =0</td></tr>
<tr class="separator:adca97acc6b0ff71f782f9c8a484a47b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f1a6c4d695e238858619a5968ca0436"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a2f1a6c4d695e238858619a5968ca0436">throttle_angle</a> =0</td></tr>
<tr class="separator:a2f1a6c4d695e238858619a5968ca0436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb66f4553a423789fdb87299e40e6b09"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#aeb66f4553a423789fdb87299e40e6b09">hold_thro_off</a> =1</td></tr>
<tr class="separator:aeb66f4553a423789fdb87299e40e6b09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0283296cf987ab548bf85e24d194add0"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a0283296cf987ab548bf85e24d194add0">auxState</a> =0</td></tr>
<tr class="separator:a0283296cf987ab548bf85e24d194add0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a214247ebd842db7f18635ef404ae477b"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a214247ebd842db7f18635ef404ae477b">flapState</a> =0</td></tr>
<tr class="separator:a214247ebd842db7f18635ef404ae477b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb51ec8bebbf85c25eb1f7e95015fae"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#abdb51ec8bebbf85c25eb1f7e95015fae">rateState</a> =0</td></tr>
<tr class="separator:abdb51ec8bebbf85c25eb1f7e95015fae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce0b5d8ed35efb23b7a912ea31b1921"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a0ce0b5d8ed35efb23b7a912ea31b1921">throState</a> =0</td></tr>
<tr class="separator:a0ce0b5d8ed35efb23b7a912ea31b1921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80c97fdfa3d709659e4a3a599c62941e"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a80c97fdfa3d709659e4a3a599c62941e">aileState</a> =0</td></tr>
<tr class="separator:a80c97fdfa3d709659e4a3a599c62941e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aa6c2482ebb112498dc4470e94d1410"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a5aa6c2482ebb112498dc4470e94d1410">elevState</a> =0</td></tr>
<tr class="separator:a5aa6c2482ebb112498dc4470e94d1410"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6ec6ec3fa207f75f5b94ad4324a14fe"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#ad6ec6ec3fa207f75f5b94ad4324a14fe">ruddState</a> =0</td></tr>
<tr class="separator:ad6ec6ec3fa207f75f5b94ad4324a14fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b1a189ab628486ec9b4057f31404b11"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a7b1a189ab628486ec9b4057f31404b11">flapswitch</a></td></tr>
<tr class="separator:a7b1a189ab628486ec9b4057f31404b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb53d122bc7b4b52d53cadac559acc0b"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#adb53d122bc7b4b52d53cadac559acc0b">pitchDemandSpin</a></td></tr>
<tr class="separator:adb53d122bc7b4b52d53cadac559acc0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace18b32da8be76b6de1b44fa4a29e755"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#ace18b32da8be76b6de1b44fa4a29e755">rollDemandSpin</a></td></tr>
<tr class="separator:ace18b32da8be76b6de1b44fa4a29e755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a472a62edf0d509f521fca523a6b62179"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a472a62edf0d509f521fca523a6b62179">pitchDemandSpinold</a></td></tr>
<tr class="separator:a472a62edf0d509f521fca523a6b62179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f93ed6bfbfdf8f073f3b5962f3cd3bc"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a1f93ed6bfbfdf8f073f3b5962f3cd3bc">rollDemandSpinold</a></td></tr>
<tr class="separator:a1f93ed6bfbfdf8f073f3b5962f3cd3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f1bd4cbcab28f474315dc545d8f58d6"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a9f1bd4cbcab28f474315dc545d8f58d6">gps_valid</a> = 0</td></tr>
<tr class="separator:a9f1bd4cbcab28f474315dc545d8f58d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72c35f17f08d2e1bb10271c4fb5f2c6"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#ac72c35f17f08d2e1bb10271c4fb5f2c6">batteryVoltage</a></td></tr>
<tr class="separator:ac72c35f17f08d2e1bb10271c4fb5f2c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cc9550b3ab20742147edf2ee0a29621"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a6cc9550b3ab20742147edf2ee0a29621">ultra</a></td></tr>
<tr class="separator:a6cc9550b3ab20742147edf2ee0a29621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac2f98bed4ad4ffb62cfb6b5a83115f3"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#aac2f98bed4ad4ffb62cfb6b5a83115f3">oldUltra</a></td></tr>
<tr class="separator:aac2f98bed4ad4ffb62cfb6b5a83115f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb3279a87ce613ae9139fc7967c9a024"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#acb3279a87ce613ae9139fc7967c9a024">ultraLoss</a> =1000</td></tr>
<tr class="separator:acb3279a87ce613ae9139fc7967c9a024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abffc5ca516aa3689a057ad62c0017996"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structalt_struct.html">altStruct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#abffc5ca516aa3689a057ad62c0017996">alt</a> ={0}</td></tr>
<tr class="separator:abffc5ca516aa3689a057ad62c0017996"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09e2e40716bdfd074ed214411a90c781"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structthree_axis_sensor_struct_gyro.html">threeAxisSensorStructGyro</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a09e2e40716bdfd074ed214411a90c781">Gyro</a> ={{0}}</td></tr>
<tr class="separator:a09e2e40716bdfd074ed214411a90c781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ef0cde845380053dd5aa78932332bef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structthree_axis_sensor_struct_accel.html">threeAxisSensorStructAccel</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#a9ef0cde845380053dd5aa78932332bef">Accel</a> ={{0}}</td></tr>
<tr class="separator:a9ef0cde845380053dd5aa78932332bef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e07a37f029c8bf0bfd8d1e83da4a05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structthree_axis_sensor_struct_mag.html">threeAxisSensorStructMag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="inputs_8c.html#af4e07a37f029c8bf0bfd8d1e83da4a05">Mag</a> ={{0}}</td></tr>
<tr class="separator:af4e07a37f029c8bf0bfd8d1e83da4a05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Sensor and user inputs. </p>
<dl class="section author"><dt>Author</dt><dd>Yuan Gao </dd>
<dd>
Henry Fletcher </dd>
<dd>
Oskar Weigl </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a9e97ee9276ed405c66f9d3f39f83ff99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void convert_ori </td>
          <td>(</td>
          <td class="paramtype">volatile signed short *&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">volatile signed short *&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">volatile signed short *&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">signed short *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts sensor axes to body axes. </p>
<p>The flight controller are mounted in different configurations on different craft, so it is possible to use the orientation of the flight controller on ARM as a method for determining which airframe is being used. This function converts the axes of the sensors into the axes of the craft body. </p>

</div>
</div>
<a class="anchor" id="a52789b5b751a66d96efbd4affda216ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_acc_sensors </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and filters the accelerometers. </p>
<p>Accelerometer data is normalised </p>

</div>
</div>
<a class="anchor" id="a299508501b2f693e86c625f7f0d6cf07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_batt_voltage </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads ADC for the battery voltage. </p>
<p>Reads the battery voltage ADC. An integer/bitwise operation can be used to obtain the battery voltage in millivolts without loosing accuracy (assuming the resistors that are part of the potential divider is ideal). But this gets filtered anyway using a SPR filter on a float. </p>

</div>
</div>
<a class="anchor" id="ab4980606e2fc3dcfdf7a38bdb74ec0d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_mag_sensors </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and filters the magnetometers. </p>
<p>Magnetometer data is corrected for soft and hard iron, and normalised. </p>

</div>
</div>
<a class="anchor" id="a1b83a366a672f3dc32fbed71e5ebe077"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_rx_input </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads RX data. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>Perform RC signal loss state setting and stuff like autoland </dd></dl>

</div>
</div>
<a class="anchor" id="aabf836b0ea199cde8e1082eeb6e1dff8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_ultrasound </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads and filters the ultrasound. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>Improve ultrasound confidence estimator </dd></dl>

</div>
</div>
<a class="anchor" id="a5e9c8a4354e4a05ed89dc4313e6ac4c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trig_batt_voltage </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">)</td><td></td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Triggers ADC for the battery voltage. </p>
<p>The ADC that is used to read the battery voltage is set to manual trigger mode instead of interrupt-driven, and therefor needs to be commanded to trigger. This function is therefore run shortly before the battery voltage is read. The ADC doesn't require that many clock cycles to complete, so not a big delay is needed. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a9ef0cde845380053dd5aa78932332bef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structthree_axis_sensor_struct_accel.html">threeAxisSensorStructAccel</a> Accel ={{0}}</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Struct for accel data </p>

</div>
</div>
<a class="anchor" id="a80c97fdfa3d709659e4a3a599c62941e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char aileState =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RX input aile switch state </p>

</div>
</div>
<a class="anchor" id="abffc5ca516aa3689a057ad62c0017996"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structalt_struct.html">altStruct</a> alt ={0}</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Struct for altitude data </p>

</div>
</div>
<a class="anchor" id="a0283296cf987ab548bf85e24d194add0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char auxState =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RX input aux switch state </p>

</div>
</div>
<a class="anchor" id="ac72c35f17f08d2e1bb10271c4fb5f2c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float batteryVoltage</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Contains battery voltage in millivolts </p>

</div>
</div>
<a class="anchor" id="a5aa6c2482ebb112498dc4470e94d1410"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char elevState =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RX input elev switch state </p>

</div>
</div>
<a class="anchor" id="a214247ebd842db7f18635ef404ae477b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char flapState =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RX input flap switch (button) state </p>

</div>
</div>
<a class="anchor" id="a7b1a189ab628486ec9b4057f31404b11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int flapswitch</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RX input flap switch toggle </p>

</div>
</div>
<a class="anchor" id="a9f1bd4cbcab28f474315dc545d8f58d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char gps_valid = 0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boolean for whether the GPS data is valid </p>

</div>
</div>
<a class="anchor" id="a09e2e40716bdfd074ed214411a90c781"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structthree_axis_sensor_struct_gyro.html">threeAxisSensorStructGyro</a> Gyro ={{0}}</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Struct for gyro data </p>

</div>
</div>
<a class="anchor" id="aeb66f4553a423789fdb87299e40e6b09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char hold_thro_off =1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boolean for holding throttle off </p>

</div>
</div>
<a class="anchor" id="af4e07a37f029c8bf0bfd8d1e83da4a05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structthree_axis_sensor_struct_mag.html">threeAxisSensorStructMag</a> Mag ={{0}}</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Struct for magneto data </p>

</div>
</div>
<a class="anchor" id="aac2f98bed4ad4ffb62cfb6b5a83115f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float oldUltra</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Contains the previous ultrasound reading </p>

</div>
</div>
<a class="anchor" id="adb53d122bc7b4b52d53cadac559acc0b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float pitchDemandSpin</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pitch demand rotated to body frame </p>

</div>
</div>
<a class="anchor" id="a472a62edf0d509f521fca523a6b62179"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float pitchDemandSpinold</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pitch demand rotated to body frame old value </p>

</div>
</div>
<a class="anchor" id="abdb51ec8bebbf85c25eb1f7e95015fae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char rateState =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RX input rate switch state </p>

</div>
</div>
<a class="anchor" id="a01020628802e60dee9f2e968dcab2f46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short rcInput[7]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Contains RX input </p>

</div>
</div>
<a class="anchor" id="ace18b32da8be76b6de1b44fa4a29e755"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float rollDemandSpin</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Roll demand rotated to body frame </p>

</div>
</div>
<a class="anchor" id="a1f93ed6bfbfdf8f073f3b5962f3cd3bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float rollDemandSpinold</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Roll demand rotated to body frame old value </p>

</div>
</div>
<a class="anchor" id="ad6ec6ec3fa207f75f5b94ad4324a14fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char ruddState =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RX input rudd switch state </p>

</div>
</div>
<a class="anchor" id="acfa8bbbd92bae257cc2aaf699f2ccaca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int rxFirst =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Counts the first few RX data, used to ignore invalid initial values </p>

</div>
</div>
<a class="anchor" id="a078122be7eecea02fe0bdd599e46208c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int rxLoss =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Increments if RX is not available </p>

</div>
</div>
<a class="anchor" id="a0ce0b5d8ed35efb23b7a912ea31b1921"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char throState =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RX input thro switch state </p>

</div>
</div>
<a class="anchor" id="adca97acc6b0ff71f782f9c8a484a47b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float throttle =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Throttle value </p>

</div>
</div>
<a class="anchor" id="a2f1a6c4d695e238858619a5968ca0436"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float throttle_angle =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Throttle adjustment when pitch/rolled </p>

</div>
</div>
<a class="anchor" id="a89aca8357300b0f6d1f6257307456b54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed short throttletrim =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initial trottle trim </p>

</div>
</div>
<a class="anchor" id="a6cc9550b3ab20742147edf2ee0a29621"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ultra</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Contains the ultrasound reading </p>

</div>
</div>
<a class="anchor" id="acb3279a87ce613ae9139fc7967c9a024"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ultraLoss =1000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Increments if ultrasound is not available </p>

</div>
</div>
<a class="anchor" id="a14eb9bc48de692883e38db2a9a6ba75c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed short yawtrim =0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initial yaw input trim </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_bfc07db8d2defe76e29ff476daeb588c.html">Thalamus</a></li><li class="navelem"><a class="el" href="inputs_8c.html">inputs.c</a></li>
    <li class="footer">Generated on Tue Sep 10 2013 23:58:08 for Mavrx Multirotor Firmware by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
